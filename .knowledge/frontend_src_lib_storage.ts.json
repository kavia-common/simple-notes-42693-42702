{"is_source_file": true, "format": "TypeScript", "description": "This file defines data types and API interfaces for managing notes in a note-taking application. It includes local storage handling, optional API fallback, and external API detection logic.", "external_files": [], "external_methods": ["localStorage.getItem", "localStorage.setItem", "JSON.parse", "JSON.stringify", "crypto.randomUUID", "fetch"], "published": ["Note", "NotesAPI", "getLocalAPI", "getAPI"], "classes": [], "methods": [{"name": "function safeReadLS(): Note[] { safeReadLS", "description": "Reads notes from local storage, falling back to seed data if necessary.", "scope": "", "scopeKind": ""}, {"name": "function writeLS(notes: Note[]) { writeLS", "description": "Writes notes array to local storage.", "scope": "", "scopeKind": ""}, {"name": "function uid() { uid", "description": "Generates a unique identifier for notes.", "scope": "", "scopeKind": ""}, {"name": "export function getLocalAPI(): NotesAPI { getLocalAPI", "description": "Provides a local-only implementation of NotesAPI using localStorage.", "scope": "", "scopeKind": ""}, {"name": "export async function getAPI(): Promise<NotesAPI> { getAPI", "description": "Detects if a remote API is reachable; if not, provides local API implementation.", "scope": "", "scopeKind": ""}], "calls": ["localStorage.getItem", "localStorage.setItem", "JSON.parse", "JSON.stringify", "crypto.randomUUID", "fetch"], "search-terms": ["localStorage notes API", "TypeScript note interface", "NotesAPI", "offline storage", "API fallback", "reachability detection"], "state": 2, "file_id": 7, "knowledge_revision": 15, "git_revision": "", "ctags": [{"_type": "tag", "name": "LS_KEY", "path": "/home/kavia/workspace/code-generation/simple-notes-42693-42702/frontend/src/lib/storage.ts", "pattern": "/^const LS_KEY = \"notes.app.v1\";$/", "language": "TypeScript", "kind": "constant"}, {"_type": "tag", "name": "Note", "path": "/home/kavia/workspace/code-generation/simple-notes-42693-42702/frontend/src/lib/storage.ts", "pattern": "/^export type Note = {$/", "language": "TypeScript", "kind": "alias"}, {"_type": "tag", "name": "NotesAPI", "path": "/home/kavia/workspace/code-generation/simple-notes-42693-42702/frontend/src/lib/storage.ts", "pattern": "/^export type NotesAPI = {$/", "language": "TypeScript", "kind": "alias"}, {"_type": "tag", "name": "SEED", "path": "/home/kavia/workspace/code-generation/simple-notes-42693-42702/frontend/src/lib/storage.ts", "pattern": "/^const SEED: Note[] = [$/", "language": "TypeScript", "kind": "constant"}, {"_type": "tag", "name": "api", "path": "/home/kavia/workspace/code-generation/simple-notes-42693-42702/frontend/src/lib/storage.ts", "pattern": "/^  const api: NotesAPI = {$/", "language": "TypeScript", "kind": "constant", "scope": "getAPI", "scopeKind": "function"}, {"_type": "tag", "name": "async", "path": "/home/kavia/workspace/code-generation/simple-notes-42693-42702/frontend/src/lib/storage.ts", "pattern": "/^    async list() {$/", "language": "TypeScript", "kind": "constant", "scope": "getAPI", "scopeKind": "function"}, {"_type": "tag", "name": "base", "path": "/home/kavia/workspace/code-generation/simple-notes-42693-42702/frontend/src/lib/storage.ts", "pattern": "/^  const base =$/", "language": "TypeScript", "kind": "constant", "scope": "getAPI", "scopeKind": "function"}, {"_type": "tag", "name": "data", "path": "/home/kavia/workspace/code-generation/simple-notes-42693-42702/frontend/src/lib/storage.ts", "pattern": "/^      const data = (await res.json()) as Note[];$/", "language": "TypeScript", "kind": "constant", "scope": "getAPI", "scopeKind": "function"}, {"_type": "tag", "name": "getAPI", "path": "/home/kavia/workspace/code-generation/simple-notes-42693-42702/frontend/src/lib/storage.ts", "pattern": "/^export async function getAPI(): Promise<NotesAPI> {$/", "language": "TypeScript", "kind": "function"}, {"_type": "tag", "name": "getLocalAPI", "path": "/home/kavia/workspace/code-generation/simple-notes-42693-42702/frontend/src/lib/storage.ts", "pattern": "/^export function getLocalAPI(): NotesAPI {$/", "language": "TypeScript", "kind": "function"}, {"_type": "tag", "name": "healthUrl", "path": "/home/kavia/workspace/code-generation/simple-notes-42693-42702/frontend/src/lib/storage.ts", "pattern": "/^  const healthUrl = `${base.replace(\\/\\\\\\/+$\\/, \"\")}\\/notes`;$/", "language": "TypeScript", "kind": "constant", "scope": "getAPI", "scopeKind": "function"}, {"_type": "tag", "name": "idx", "path": "/home/kavia/workspace/code-generation/simple-notes-42693-42702/frontend/src/lib/storage.ts", "pattern": "/^        ...list[idx],$/", "language": "TypeScript", "kind": "constant", "scope": "getLocalAPI", "scopeKind": "function"}, {"_type": "tag", "name": "idx", "path": "/home/kavia/workspace/code-generation/simple-notes-42693-42702/frontend/src/lib/storage.ts", "pattern": "/^      const idx = list.findIndex((n) => n.id === id);$/", "language": "TypeScript", "kind": "constant", "scope": "getLocalAPI", "scopeKind": "function"}, {"_type": "tag", "name": "list", "path": "/home/kavia/workspace/code-generation/simple-notes-42693-42702/frontend/src/lib/storage.ts", "pattern": "/^      const list = safeReadLS();$/", "language": "TypeScript", "kind": "constant", "scope": "getLocalAPI", "scopeKind": "function"}, {"_type": "tag", "name": "list", "path": "/home/kavia/workspace/code-generation/simple-notes-42693-42702/frontend/src/lib/storage.ts", "pattern": "/^    async list() {$/", "language": "TypeScript", "kind": "constant", "scope": "getAPI", "scopeKind": "function"}, {"_type": "tag", "name": "next", "path": "/home/kavia/workspace/code-generation/simple-notes-42693-42702/frontend/src/lib/storage.ts", "pattern": "/^      const next = [...list];$/", "language": "TypeScript", "kind": "constant", "scope": "getLocalAPI", "scopeKind": "function"}, {"_type": "tag", "name": "next", "path": "/home/kavia/workspace/code-generation/simple-notes-42693-42702/frontend/src/lib/storage.ts", "pattern": "/^      const next = [note, ...safeReadLS()];$/", "language": "TypeScript", "kind": "constant", "scope": "getLocalAPI", "scopeKind": "function"}, {"_type": "tag", "name": "next", "path": "/home/kavia/workspace/code-generation/simple-notes-42693-42702/frontend/src/lib/storage.ts", "pattern": "/^      const next = safeReadLS().filter((n) => n.id !== id);$/", "language": "TypeScript", "kind": "constant", "scope": "getLocalAPI", "scopeKind": "function"}, {"_type": "tag", "name": "note", "path": "/home/kavia/workspace/code-generation/simple-notes-42693-42702/frontend/src/lib/storage.ts", "pattern": "/^      const note: Note = {$/", "language": "TypeScript", "kind": "constant", "scope": "getLocalAPI", "scopeKind": "function"}, {"_type": "tag", "name": "now", "path": "/home/kavia/workspace/code-generation/simple-notes-42693-42702/frontend/src/lib/storage.ts", "pattern": "/^      const now = new Date().toISOString();$/", "language": "TypeScript", "kind": "constant", "scope": "getLocalAPI", "scopeKind": "function"}, {"_type": "tag", "name": "parsed", "path": "/home/kavia/workspace/code-generation/simple-notes-42693-42702/frontend/src/lib/storage.ts", "pattern": "/^    const parsed = JSON.parse(raw);$/", "language": "TypeScript", "kind": "constant", "scope": "safeReadLS", "scopeKind": "function"}, {"_type": "tag", "name": "raw", "path": "/home/kavia/workspace/code-generation/simple-notes-42693-42702/frontend/src/lib/storage.ts", "pattern": "/^    const raw = localStorage.getItem(LS_KEY);$/", "language": "TypeScript", "kind": "constant", "scope": "safeReadLS", "scopeKind": "function"}, {"_type": "tag", "name": "res", "path": "/home/kavia/workspace/code-generation/simple-notes-42693-42702/frontend/src/lib/storage.ts", "pattern": "/^      const res = await fetch(`${base}\\/notes\\/${encodeURIComponent(id)}`, { method: \"DELETE\" })/", "language": "TypeScript", "kind": "constant"}, {"_type": "tag", "name": "res", "path": "/home/kavia/workspace/code-generation/simple-notes-42693-42702/frontend/src/lib/storage.ts", "pattern": "/^      const res = await fetch(`${base}\\/notes\\/${encodeURIComponent(id)}`, {$/", "language": "TypeScript", "kind": "constant"}, {"_type": "tag", "name": "res", "path": "/home/kavia/workspace/code-generation/simple-notes-42693-42702/frontend/src/lib/storage.ts", "pattern": "/^      const res = await fetch(`${base}\\/notes`, {$/", "language": "TypeScript", "kind": "constant"}, {"_type": "tag", "name": "res", "path": "/home/kavia/workspace/code-generation/simple-notes-42693-42702/frontend/src/lib/storage.ts", "pattern": "/^    const res = await fetch(healthUrl, { method: \"GET\", headers: { Accept: \"application\\/json\" }/", "language": "TypeScript", "kind": "constant", "scope": "getAPI", "scopeKind": "function"}, {"_type": "tag", "name": "safeReadLS", "path": "/home/kavia/workspace/code-generation/simple-notes-42693-42702/frontend/src/lib/storage.ts", "pattern": "/^function safeReadLS(): Note[] {$/", "language": "TypeScript", "kind": "function"}, {"_type": "tag", "name": "title", "path": "/home/kavia/workspace/code-generation/simple-notes-42693-42702/frontend/src/lib/storage.ts", "pattern": "/^        title: payload.title.trim() || \"Untitled\",$/", "language": "TypeScript", "kind": "constant", "scope": "getLocalAPI", "scopeKind": "function"}, {"_type": "tag", "name": "uid", "path": "/home/kavia/workspace/code-generation/simple-notes-42693-42702/frontend/src/lib/storage.ts", "pattern": "/^function uid() {$/", "language": "TypeScript", "kind": "function"}, {"_type": "tag", "name": "updated", "path": "/home/kavia/workspace/code-generation/simple-notes-42693-42702/frontend/src/lib/storage.ts", "pattern": "/^      const updated: Note = {$/", "language": "TypeScript", "kind": "constant", "scope": "getLocalAPI", "scopeKind": "function"}, {"_type": "tag", "name": "writeLS", "path": "/home/kavia/workspace/code-generation/simple-notes-42693-42702/frontend/src/lib/storage.ts", "pattern": "/^function writeLS(notes: Note[]) {$/", "language": "TypeScript", "kind": "function"}], "hash": "ef2fd9e134b0c17e776fe2526f3ab49b", "format-version": 4, "code-base-name": "frontend", "filename": "frontend/src/lib/storage.ts", "revision_history": [{"15": ""}]}